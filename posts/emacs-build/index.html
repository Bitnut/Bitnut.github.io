<!DOCTYPE html>
<html><head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>编译安装 emacs</title>
    <meta name="description" content="A simple monospaced resume theme for Hugo.">
    <meta name="author" content='三口一个瓜'>

    <link href="https://fonts.googleapis.com/css2?family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">

    
    <link rel="stylesheet" href="/sass/researcher.min.css">

    
        <link rel="icon" type="image/ico" href="https://bitnut.github.io/favicon.ico">
    

    
        
    
</head>

    <body><div class="container mt-5">
    <nav class="navbar navbar-expand-sm flex-column flex-sm-row text-nowrap p-0">
        <a class="navbar-brand mx-0 mr-sm-auto" href="https://bitnut.github.io">
          
          三口一个瓜的博客
        </a>
        <div class="navbar-nav flex-row flex-wrap justify-content-center">
            
                
                
                    <a class="nav-item nav-link" href="/posts/">
                        博客
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/abo">
                        关于我
                    </a>
                    
                        <span class="nav-item navbar-text mx-1">/</span>
                    
                
                    <a class="nav-item nav-link" href="/contact">
                        联系方式
                    </a>
                    
                
            
        </div>
    </nav>
</div>
<hr>
<div id="content">
<div class="container">
    <h3 id="走个流程">走个流程</h3>
<ol>
<li>源码下载</li>
</ol>
<p>到 emacs 的<a href="https://www.gnu.org/software/emacs/download.html">官网</a>下载安装包
当我写这篇博客的时候，emacs 的最新稳定版是 27.1</p>
<ol start="2">
<li>解压安装包</li>
</ol>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">xz -d emacs-27.1.tar.xz
tar -xvf emacs-27.1.tar
</code></pre></div><ol start="3">
<li>配置安装选项</li>
</ol>
<p><code>./configure --prefix=/opt/emacs/ --with-mailutils --with-pop &gt;/dev/null 2&gt;&amp;1</code></p>
<p>可能会遇到一些依赖保错</p>
<p>可以执行：</p>
<ul>
<li>X toolkit 的报错：</li>
</ul>
<p><code>sudo apt-get install build-essential texinfo libx11-dev libxpm-dev libjpeg-dev libpng-dev libgif-dev libtiff-dev libgtk2.0-dev libgtk-3-dev libncurses-dev libxpm-dev automake autoconf</code></p>
<ul>
<li>gnutls 的报错：</li>
</ul>
<p><code>sudo apt-get install gnutls-dev</code></p>
<ol start="4">
<li>执行 make</li>
</ol>
<p><code>make &amp;&amp; make install</code></p>
<p>如果遇到依赖问题：</p>
<p><code>sudo apt-get install make</code></p>
<ol start="5">
<li>添加软连接</li>
</ol>
<p>ln -s /opt/emacs/bin/emacs /usr/bin/emacs</p>
<p>下面给出我写好的一个自用脚本：</p>
<h3 id="脚本">脚本</h3>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">
<span style="color:#75715e">#!/bin/bash</span>

packageArr<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
package<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
unzipFile<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
targetDir<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>
files<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;&#34;</span>

<span style="color:#66d9ef">function</span> getFile<span style="color:#f92672">()</span> <span style="color:#f92672">{</span>


    echo <span style="color:#e6db74">&#34;Getting emacs packages&#34;</span>;
    files<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>ls $1 | grep -E <span style="color:#e6db74">&#39;emacs.*xz|emacs.*tar&#39;</span><span style="color:#66d9ef">)</span>;
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">${#</span>files<span style="color:#e6db74">}</span> -eq <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>;<span style="color:#66d9ef">then</span> echo <span style="color:#e6db74">&#34;cannot find emacs release packages&#34;</span>; exit 1; <span style="color:#66d9ef">fi</span>
    packageArr<span style="color:#f92672">=()</span>
    <span style="color:#66d9ef">for</span> file in $files
    <span style="color:#66d9ef">do</span>
        packageArr<span style="color:#f92672">[</span><span style="color:#e6db74">${#</span>packageArr[@]<span style="color:#e6db74">}</span><span style="color:#f92672">]=</span>$file
    <span style="color:#66d9ef">done</span>
    package<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>packageArr[0]<span style="color:#e6db74">}</span>;
    unzipFile<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>package%<span style="color:#ae81ff">\.</span>xz<span style="color:#e6db74">}</span>
    targetDir<span style="color:#f92672">=</span><span style="color:#e6db74">${</span>unzipFile%<span style="color:#ae81ff">\.</span>tar<span style="color:#e6db74">}</span>
    echo <span style="color:#e6db74">&#34;get eamcs packages complete&#34;</span>;
<span style="color:#f92672">}</span>

getFile

echo <span style="color:#e6db74">&#34;unziping package&#34;</span> <span style="color:#e6db74">${</span>package<span style="color:#e6db74">}</span>
echo <span style="color:#e6db74">&#34;...&#34;</span>
<span style="color:#75715e"># xz -d ${package}</span>

echo <span style="color:#e6db74">&#34;unziping tar file&#34;</span> <span style="color:#e6db74">${</span>unzipFile<span style="color:#e6db74">}</span>
echo <span style="color:#e6db74">&#34;...&#34;</span>
tar -xvf <span style="color:#e6db74">${</span>unzipFile<span style="color:#e6db74">}</span> &gt; /dev/null

cd <span style="color:#e6db74">${</span>targetDir<span style="color:#e6db74">}</span>
echo <span style="color:#e6db74">&#34;configuring emacs to /opt/emacs&#34;</span>
echo <span style="color:#e6db74">&#34;...&#34;</span>


./configure --prefix<span style="color:#f92672">=</span>/opt/emacs/ --with-mailutils --with-pop &gt;/dev/null 2&gt;&amp;<span style="color:#ae81ff">1</span>

echo <span style="color:#e6db74">&#34;Doing make and make install&#34;</span>

make

make install

echo <span style="color:#e6db74">&#34;Adding soft link&#34;</span>

ln -s /opt/bin/emacs /usr/bin/emacs

</code></pre></div>
</div>

        </div><div id="footer" class="mb-5">
    
        <hr>
        <div class="container text-center">
            <a href="https://github.com/Bitnut"><small>By 三口一个瓜</small></a>
        </div>
    
</div>
</body>
</html>
